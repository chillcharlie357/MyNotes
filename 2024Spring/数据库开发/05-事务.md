---
aliases: 
tags: 
categories: 
sticky: 
thumbnail: 
cover: 
excerpt: false
mathjax: true
comment: true
title: 05-事务
date:  2024-04-08 14:04
modified:  2024-04-10 11:04
---
# 事务处理

A 原子性：事务本质要求
C 一致性：数据完整要求，开发者控制而不是数据库控制
I 隔离性：并发的要求
D 持久性：数据库系统要求


事务调度管理器
锁管理器：保证隔离性，锁的粒度决定隔离级别
页缓存：充当持久化存储和存储引擎其余部分之间的中介
日志管理器
分布式事务协调



# 缓冲区管理 Buffer Management

1. 双层存储是大部分数据库的基础
2. 页缓存
	1. Page in 换入
	2. Flush 刷写
	3. Evict 换出

缓存页什么时候换出？提早换出，还是刷写时才换出？
## 在缓存中锁定页

1. B+树越靠近顶部越窄，层次较高的节点在大多数读取中都会被命中
2. 分裂和合并操作最终会传播到高层节点
3. 频繁的子树结构变化，可以一起处理



## 页置换策略选择

缓存更大不能减少换出次数，Beadly异常


1. FIFO
2. LRU：最长时间未使用策略
	1. 范围查询时，连续查询叶节点，叶节点虽然只被读一次但会把根节点换出去
3. LRU-K：最近K次访问频繁用到的页，并使用此信息估计访问时间
4. 2Q的LRU（双队列，k=2）：后续访问移入第二个队列，从而区分最近访问和经常访问
5. LFU
6. CLOCK

