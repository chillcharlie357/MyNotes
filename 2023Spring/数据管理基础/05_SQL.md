- **SQL（Structured Query Language）** 结构化查询语言，是关系数据库的标准语言
 是一个ISO标准，变种和版本极多，概念和实际实现也有差异
- 本课程使用MySQL，环境无所谓



# 特点
- 综合统一
- 高度非过程化
	- 看不见内模式，不知道具体操作的步骤
	- 只需要告诉SQL**做什么**
- 面向集合的操作方式
	- 所有的分量、标量都是集合
	- nullptr=>空集
	- 4=>一个元素的集合
- 以同一种语法结构提供两种使用方法
	- 独立语言
	- 嵌入式语言，嵌入高级语言（C++,java...）
- 语言简洁，易学易用（？）
	- 核心功能9个动词

## SQL与数据库三级模式
不自由，但确保不会出错



# SQL数据定义
ch12
## 层次化的数据库对象命名机制
- 一个关系数据库管理系统的实例（Instance）中可以建立多个数据库
- 一个数据库中可以建立多个模式
	- 类比：一个用户多个文件夹
	- 一个数据库也可能只有一个模式
- 一个模式下通常包括多个表、视图和索引等数据库对象
	- 表：文件 
	- 视图：文件的分身
	- 索引：加速查找
![POWERPNT_319_208.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/imgae/2023/03/09/80de805b7fb0bde22482a9b302292210_POWERPNT_319_208.png)
## 数据定义
### 定义
- `CREATE SCHEMA <模式名> AUTHORIZATION <用户名>  [<表定义子句>| <视图定义子句>|<授权定义子句>]`

- 模式定义
	- 模式==>namespace
- 表定义
- 视图和索引定义

### 删除
- `DROP SCHEMA <模式名> <CASCADE|RESTRICT>`
- 级联CASCADE
	- eg: windows删除文件夹递归删除
	- 删除模式的同时把该模式中所有的数据库对象全部删除
- 限制RESTRICT
	- eg: linux非空文件夹无法直接rm
	- 如果该模式中定义了下属的数据库对象（如表、视图等），则拒绝该删除语句的执行
	- 仅当该模式中没有任何下属的对象时才能执行

限制考虑安全性，级联考虑便利性

### 定义基本表

CREATE TABLE <表名>
      (<列名> <数据类型>[ <列级完整性约束条件> ]
      [,<列名> <数据类型>[ <列级完整性约束条件>] ] 
   …
      [,<表级完整性约束条件> ] );
<表名>：所要定义的基本表的名字
<列名>：组成该表的各个属性（列）
<列级完整性约束条件>：涉及相应属性列的完整性约束条件
<表级完整性约束条件>：涉及一个或多个属性列的完整性约束条件 
如果完整性约束条件涉及到该表的多个属性列，则必须定义在表级上，否则既可以定义在列级也可以定义在表级。 


### 数据类型

- SQL中域的概念用数据类型来实现
- 定义表的属性时需要指明其数据类型及长度 
- 选用哪种数据类型 
	- 取值范围 
	- 要做哪些运算 
![POWERPNT_645_418.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/imgae/2023/03/09/1951d6c8c0607e4d87893b9774c13fdb_POWERPNT_645_418.png)
### 修改基本表
- 在关系型数据库中，先有型再有数据，加入新的数据要按照形
- nosql可以不要型

ALTER TABLE <表名>
[ ADD[COLUMN] <新列名> <数据类型> [ 完整性约束 ] ]
[ ADD <表级完整性约束>]
[ DROP [ COLUMN ] <列名> [CASCADE| RESTRICT] ]
[ DROP CONSTRAINT<完整性约束名>[ RESTRICT | CASCADE ] ]
[ALTER COLUMN <列名><数据类型> ] ;

<表名>是要修改的基本表
- `ADD`子句用于增加新列、新的列级完整性约束条件和新的表级完整性约束条件
- `DROP COLUMN`子句用于删除表中的列
	- 如果指定了`CASCADE`短语，则自动删除引用了该列的其他对象
	- 如果指定了`RESTRICT`短语，则如果该列被其他对象引用，关系数据库管理系统将拒绝删除该列
- `DROP CONSTRAINT`子句用于删除指定的完整性约束条件
- `ALTER COLUMN`子句用于修改原有的列定义，包括修改列名和数据类型

### 删除基本表
- DROP TABLE <表名>［RESTRICT| CASCADE］;
- RESTRICT：删除表是有限制的。
	- 欲删除的基本表不能被其他表的约束所引用
	- 如果存在依赖该表的对象，则此表不能被删除
- CASCADE：删除该表没有限制。
	- 在删除基本表的同时，相关的依赖对象一起删除 

### 索引
- 建立索引的目的：加快查询速度。提升查询效率，降低增删改效率的数据结构
	- 由数据库**管理员**或表的**拥有者**建立，大多数情况下使用者就是建立者
	- 由关系数据库管理系统**自动完成维护**
	- 关系数据库管理系统自动使用合适的索引作为存取路径，用户不必也**不能显式地选择索引**
- 关系数据库管理系统中常见索引：
	- 顺序文件上的索引
	- B+树索引
	- 散列（hash）索引
	- 位图索引

- **索引语句**：`CREATE [UNIQUE] [CLUSTER] INDEX <索引名> ON <表名>(<列名>[<次序>][,<列名>[<次序>] ]…); `
	- <表名>：要建索引的基本表的名字
	- 索引：可以建立在该表的一列或多列上，各列名之间用逗号分隔
	- <次序>：指定索引值的排列次序，升序：ASC，降序：DESC。缺省值：ASC
	- UNIQUE：此索引的每一个索引值只对应唯一的数据记录
	- CLUSTER：表示要建立的索引是聚簇索引


