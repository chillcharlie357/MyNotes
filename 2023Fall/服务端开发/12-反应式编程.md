---
aliases: 
tags:
  - 2023_Fall_æœåŠ¡ç«¯å¼€å‘
  - è¯¾ç¨‹
categories: 2023_Fall_æœåŠ¡ç«¯å¼€å‘
sticky:
thumbnail:
cover: 
excerpt: false
mathjax: true
comment: true
title: 12-ååº”å¼ç¼–ç¨‹
date:  Thursday,November 30th 2023
modified:  Thursday,December 28th 2023
---

# 1. ä½¿ç”¨åœºæ™¯

- IOå¯†é›†å‹åœºæ™¯
- åŒæ­¥é˜»å¡æ¨¡å‹ï¼Œé˜»å¡çº¿ç¨‹å¤šï¼ŒCPUåˆ©ç”¨ç‡ä¸é«˜ï¼Œæ€§èƒ½ä¸‹é™
- ç®¡ç†å¤šçº¿ç¨‹ï¼Œæ„å‘³ç€æ›´é«˜çš„å¤æ‚æ€§

# 2. ReactorğŸ‘

- **Reactive Streams**ï¼šNetflixã€Lightbendå’ŒPirotaläº2013å¹´å¼€å§‹åˆ¶å®šçš„**ä¸€ç§è§„èŒƒ**ï¼Œæ—¨åœ¨æä¾›æ— é˜»å¡å›å‹çš„å¼‚æ­¥æµå¤„ç†æ ‡å‡†
	- å’ŒJDKé‡Œçš„Streamä¸æ˜¯åŒä¸€ä¸ªä¸œè¥¿
- **Reactor**ï¼šSpring Pivotalå›¢é˜Ÿæä¾›çš„å“åº”å¼ç¼–ç¨‹çš„Javaå®ç°ï¼Œå…¶å®ƒç±»ä¼¼å®ç°ï¼šRxJava
	- å‡½æ•°å¼ã€å£°æ˜å¼ï¼Œæè¿°æ•°æ®ä¼šæµç»çš„ç®¡é“æˆ–æµ
- **Spring WebFlux**ï¼šå¯ç”¨åŸºäºå“åº”å¼ç¼–ç¨‹çš„Webåº”ç”¨ç¨‹åºçš„å¼€å‘ã€‚æä¾›ç±»ä¼¼äºSpring MVCçš„ç¼–ç¨‹æ¨¡å‹

# 3. Javaçš„streamä¸ååº”å¼çš„æµåŒºåˆ«ğŸ‘

1. **Javaçš„streamé€šå¸¸éƒ½æ˜¯åŒæ­¥çš„**ï¼Œå¹¶ä¸”åªèƒ½å¤„ç†æœ‰é™çš„æ•°æ®é›†ï¼Œæœ¬è´¨ä¸Šæ¥è¯´ï¼Œå®ƒä»¬åªæ˜¯ä½¿ç”¨å‡½æ•°æ¥å¯¹é›†åˆè¿›è¡Œè¿­ä»£çš„ä¸€ç§æ–¹å¼
2. JDK9ä¸­çš„ **Flow APIå¯¹åº”ååº”å¼æµ**

# 4. ååº”å¼æµè§„èŒƒå®šä¹‰çš„4ä¸ªæ¥å£ğŸ‘

- org.reactivestreams.*

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F19-07-41-798ed044f2aa4ce418bbeb6519cfa668-20231130190741-06575a.png)

- Publisherï¼šæ•°æ®å‘å¸ƒè€…
- Subscriberï¼šæ•°æ®è®¢é˜…è€…
- Peocessorï¼šå¤„ç†å™¨
- Subscriptionï¼šåè°ƒ

å¤„ç†è¿‡ç¨‹æ˜¯å¼‚æ­¥çš„  

<font color="#c00000">æ¶ˆè´¹è€…é©±åŠ¨ï¼Œæ¶ˆè´¹è€…å»è¯·æ±‚å‘å¸ƒè€…æ‰ä¼šå‘å¸ƒæ•°æ®</font>

# 5. åŸºæœ¬æ¦‚å¿µ

1. Fluxï¼šåŒ…å« 0 åˆ° N ä¸ªå…ƒç´ çš„å¼‚æ­¥åºåˆ—
2. Monoï¼šåŒ…å« 0 æˆ–è€… 1 ä¸ªå…ƒç´ çš„å¼‚æ­¥åºåˆ—
3. æ¶ˆæ¯ï¼šæ­£å¸¸çš„åŒ…å«å…ƒç´ çš„æ¶ˆæ¯ã€åºåˆ—ç»“æŸçš„æ¶ˆæ¯å’Œåºåˆ—å‡ºé”™çš„æ¶ˆæ¯
4. æ“ä½œç¬¦ï¼ˆOperatorï¼‰ï¼šå¯¹æµä¸Šå…ƒç´ çš„æ“ä½œ

# 6. ååº”å¼æµå›¾

## 6.1. Flux

Fluxï¼šå‘é€0-nä¸ªå…ƒç´ çš„å¼‚æ­¥åºåˆ—

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F19-50-28-2478db88115146681d4269a2e67204e8-20231130195028-f96d09.png)

## 6.2. Mono

Monoï¼š0-1ä¸ªæ•°æ®

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F19-50-35-43b84d1bac8df3886bab7388fbc8422d-20231130195034-f55784.png)

# 7. æµçš„æ“ä½œ

- ç±»å‹
	- åˆ›å»ºæ“ä½œ
	- ç»„åˆæ“ä½œ
	- è½¬æ¢æ“ä½œ 
	- é€»è¾‘æ“ä½œ

## 7.1. åˆ›å»ºFlux

- Fluxçš„é™æ€æ–¹æ³•
	- `just`ï¼šæ ¹æ®å¯¹è±¡åˆ›å»º
	- `fromArray`ï¼šæ ¹æ®é›†æˆåˆ›å»ºï¼Œæ•°ç»„ã€Iterableã€Java Stream

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F20-19-30-099704152461e9b25bdbbf87419d26a9-20231130201930-4b546d.png)

## 7.2. ç»„åˆFluxæµ

- mergeWith
- zipï¼šè‡ªå·±å†³å®šå¦‚ä½•åˆå¹¶
- firstï¼šå–ä¸¤ä¸ªæµé‡Œé¢æœ€å…ˆæœ‰çš„æ•°æ®

## 7.3. è¿‡æ»¤Fluxæµ

- skipï¼šæŒ‡å®šä¸ªæ•°/æ—¶é—´
- takeï¼šæŒ‡å®šä¸ªæ•°/æ—¶é—´
- filterï¼šéœ€è¦æä¾›Predicate
- distinctï¼šåªå‘å¸ƒæºFluxä¸­å°šæœªå‘å¸ƒè¿‡çš„æ•°æ®é¡¹

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F20-50-27-9624d81ea1b9b815676419eb53eb71a3-20231130205026-100752.png)

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F20-50-36-9648126cc6e148b104e4369205f43c63-20231130205035-0bc08f.png)

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F20-50-08-1dc3601d6deecab36c6e8e25231983b3-20231130205008-b20327.png)

## 7.4. è½¬æ¢Fluxæµ

### 7.4.1. map/flatMap ğŸ‘

- mapï¼š
	- åŒæ­¥
	- è¿”å›å…·ä½“å€¼
- **flatMap**ï¼š
	- å¼‚æ­¥
	- è½¬æ¢å‡ºæ¥çš„**è¿”å›ç»“æœè¿˜æ˜¯ä¸€ä¸ªæµï¼ˆMono/Fluxï¼‰**
	- å¯ä»¥å¹¶å‘å¤„ç†ï¼ŒæŒ‡å®šç”¨å“ªä¸ªå¹¶å‘æ¨¡å‹å¤„ç†
		- å¤šä¸ªæµå¹¶å‘å¤„ç†ç»“æœåˆå¹¶æˆä¸€ä¸ªæµï¼Œä½†ç»“æœé¡ºåºä¸å¯æ§
	- æ‰å¹³åŒ–

- **å¹¶å‘æ¨¡å‹ï¼ˆSchedulersæ–¹æ³•ï¼‰**
	- .immediate()
	- .single()
	- .newSingle()
	- .elastic()
	- .parallel()

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F20-49-26-5285b7a6ede0772dea032de105737181-20231130204925-7ab7ac.png)

**å¦‚æœmapè¿”å›æµä¼šæ€ä¹ˆæ ·**ï¼Ÿæ²¡æœ‰ä¸‹æ¸¸è®¢é˜…è€…é©±åŠ¨ï¼Œæµæ˜¯æ­»çš„(æµä¸è¢«è®¢é˜…å°±ä¸ä¼šå‘é€ä»»ä½•äº‹æƒ…)ã€‚

### 7.4.2. ç¼“å†²

- bufferï¼Œç¼“å†²æ•°æ®ï¼ŒbufferAndFlatMap
- collectListï¼ŒåŒï¼šbufferä¸å¸¦å‚æ•°åˆ™ç¼“å†²æ‰€æœ‰æ•°æ®åˆ°åˆ—è¡¨
- collectMapï¼Œéœ€è¦æä¾›ç”Ÿæˆkeyçš„å‡½æ•°

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F21-01-17-a2c87fea5eefda93fbc122c479c890d2-20231130210117-9de6d6.png)

## 7.5. é€»è¾‘æ“ä½œ

- all
	- è¦æä¾›Predicateå‡½æ•°
	- æ‰€æœ‰å…ƒç´ æ»¡è¶³æ¡ä»¶True
	- **è¿”å›**`Mono<Boolean>` 
- any
	- è¦æä¾›Predicateå‡½æ•°
	- æœ‰å…ƒç´ æ»¡è¶³æ¡ä»¶è¿”å›True
	- **è¿”å›**`Mono<Boolean>`

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F11%2F30%2F21-19-03-bb543500e23441c4ac493e1c1cb9e6f4-20231130211902-2aeca5.png)

# 8. ä¸åŒçš„æ¶ˆæ¯

- ååº”å¼ç¼–ç¨‹
	- åªåœ¨JVMä¸­æµåŠ¨
- spring intergrestion
	- headerï¼šæ¶ˆæ¯å¤´
	- payloadï¼šæ¶ˆæ¯ä½“
	- åªåœ¨JVMä¸­æµåŠ¨
- æ¶ˆæ¯é˜Ÿåˆ—
	- ä¹Ÿæœ‰headerå’Œpayload
	- è¦åœ¨ç½‘ç»œä¸­æµåŠ¨ï¼Œæ‰€ä»¥éœ€è¦æ¶ˆæ¯è½¬æ¢å™¨ï¼ˆåºåˆ—åŒ–/ååºåˆ—åŒ–ï¼‰