---
aliases: 
tags: 
categories:
sticky:
thumbnail:
cover: 
excerpt: false
mathjax: true
comment: true
title: 2-面向切面编程
date:  Thursday,September 21st 2023
modified:  Thursday,September 21st 2023
---

# 软件编程方法

- 面向过程编程 POP
- 面向对象编程 OOP
- 面向切面编程 AOP
- 函数式编程 FP
- 反应式编程 RP

# AOP: Aspect Oriented Programming

## 横切关注点

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F09%2F21%2F593c95764eb4ced35052b11e904cb58c_20230921200636.png)

### 定义

- 横切关注点：公共性的功能，但需要嵌入到业务代码的许多地方
	- Cross-cutting concern
	- 例：来了一个请求，需要权限认证。权限认证与业务逻辑无关，且许多地方要用到。

Spring会帮开发者嵌入横切关注点

### 类型

1. 日志
2. 安全
3. 事务
4. 缓存

# AOP术语

1. **通知 Advice**：切面要做什么以及何时做
	- 时间：方法前/后...
2. **切点 Pointcut**：何处
	- Spring只支持在方法的前后切
	- 写**切点表达式**指定
3. **切面 Aspect**：Advice和Pointcut的结合
	- 包含切的所有逻辑
4. **连接点 Join point**：方法、字段修改、构造方法
5. **引入 introduction**：引入新的行为和状态
	- 给对象加入新的方法/状态，但不需要实现新的子类。在原来的对象上动态加入新的方法/状态。
6. **织入 Weaving**：切面应用到目标对象的过程

## 通知（Advice）类型

- @Before
- @After：不区分是否正常结束
- @AfterReturning
- @AfterThrowing
- @Around：结合前面所有类型

## 切面 Aspect

- 在类上加`@Aspect`注解
- 包含切的时间、切点和逻辑
- 是一个单独的类

==不需要修改业务代码==

### 使用步骤

1. 写Advice和切点表达式
2. 在切面类增加注解`@EnableAspectJProxy`
3. 定义Bean

### 切点表达式

`@Before(<切点表达式>)`

包路径.方法

### 原理

- 切与不切通过`getBean`获得的对象类型并不一样。
- 通过创建**代理**实现
	- JDK本身就具备代理能力
	- 针对该对象的调用都会转到代理对象

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F09%2F21%2F0e23d5f342f4383c7a76122ca75ea479_20230921200101.png)

