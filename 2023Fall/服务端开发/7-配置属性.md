---
aliases: 
tags:
  - 2023_Fall_æœåŠ¡ç«¯å¼€å‘
  - è¯¾ç¨‹
categories: 2023_Fall_æœåŠ¡ç«¯å¼€å‘
sticky:
thumbnail:
cover: 
excerpt: false
mathjax: true
comment: true
title: 7-é…ç½®å±æ€§
date:  Thursday,October 26th 2023
modified:  Thursday,December 28th 2023
---

# 1. å±æ€§æ¥æºğŸ‘

ä¸ä»…ä»…æ˜¯Spring Bootéœ€è¦çš„å±æ€§ï¼Œä¹ŸåŒ…å«æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å±æ€§ã€‚

1. **é…ç½®æ–‡ä»¶**`application.yml`ã€`application.properties`ï¼Œä¸¤ä¸ªæ–‡ä»¶å¯ä»¥æ··ç”¨
	- `server.port = 8090`
2. **å‘½ä»¤è¡Œå‚æ•°**`commandLineArgs`ï¼Œåœ¨ç¨‹åºä¸­ç›´æ¥è·å–
	- `java -jar taco-cloud-sd-jdbc-0.0.3-SNAPSHOT.jar -- server.port=8081`
3. **JVMç³»ç»Ÿå‚æ•°** `-D`
	- `java -Dserver.port=8091 -jar taco-cloud-sd-jdbc-0.0.3-SNAPSHOT.jar`
4. **æ“ä½œç³»ç»Ÿç¯å¢ƒå˜é‡**
	- `set SERVER_PORT=8082ã€java -jar taco-cloud-sd-jdbc-0.0.3-SNAPSHOT.jar`

# 2. YAMLæ–‡ä»¶

- ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼Œä¸å…è®¸ä½¿ç”¨Tabå»ºï¼Œ**åªèƒ½ä½¿ç”¨ç©ºæ ¼**(ä¸€èˆ¬2ä¸ªç©ºæ ¼)
- \# è¡¨ç¤ºæ³¨é‡Š
- å¯¹è±¡ï¼šé”®å€¼å¯¹ï¼Œä½¿ç”¨å†’å·ç»“æ„è¡¨ç¤º
	- å†’å·åé¢åŠ ç©ºæ ¼
	- `animal: pets`
	- `hash: {name: Steve, foo: bar}`
- ä¸€èˆ¬æ•°ç»„ï¼šä¸€ç»„è¿çº¿å¼€å¤´çš„è¡Œï¼Œæ„æˆä¸€ä¸ªæ•°ç»„

```yaml
- Cat
- Dog
- Goldfish
```

- è¡Œå†…æ•°ç»„ï¼š`animal: [Cat, Dog]`

# 3. é…ç½®æ•°æ®æº

- org.h2.Driver
- com.mysql.cj.jdbc.Driver

ä¸ä¸€å®šè¦åœ¨application.yamlé‡Œæ˜¾å¼æŒ‡å®šï¼Œåªæ·»åŠ å¯¹åº”ä¾èµ–springä¹Ÿèƒ½è¯†åˆ«

# 4. å»ºç«‹HTTPSå®‰å…¨é€šé“

- è§£å†³å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¼ è¾“æ•°æ®æ—¶çš„åŠ å¯†é—®é¢˜
	- HTTPæ˜æ–‡ä¼ è¾“æ•°æ®ï¼Œä¸å®‰å…¨
	- TLS/SSLå…·æœ‰èº«ä»½è®¤è¯ã€ä¿¡æ¯åŠ å¯†å’Œå®Œæ•´æ€§æ ¡éªŒ

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F26%2F609986015a78cfd18e72b154942d8f25_20231026200319.png)

**SSL(Secure Sockets Layer å®‰å…¨å¥—æ¥å­—åè®® )**ï¼ŒåŠå…¶ç»§ä»»è€…**ä¼ è¾“å±‚å®‰å…¨ï¼ˆTransport Layer Security ï¼Œ TLSï¼‰** æ˜¯ä¸ºç½‘ç»œé€šä¿¡æä¾›å®‰å…¨åŠæ•°æ®å®Œæ•´æ€§çš„ä¸€ç§å®‰å…¨åè®®ã€‚TLS ä¸SSLåœ¨ä¼ è¾“å±‚ä¸åº”ç”¨å±‚ä¹‹é—´å¯¹ç½‘ ç»œè¿æ¥è¿›è¡ŒåŠ å¯†ã€‚

## 4.1. å•å‘è®¤è¯

- å®¢æˆ·ç«¯æ ¡éªŒæœåŠ¡ç«¯è¯ä¹¦çš„åˆæ³•æ€§ï¼ŒæœåŠ¡ç«¯ä¸éœ€è¦æ ¡éªŒå®¢æˆ·ç«¯

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F26%2Fb843eb927502da6e44df35255de08531_20231026200909.png)

## 4.2. åŒå‘è®¤è¯

- å®¢æˆ·ç«¯è¦æ ¡éªŒæœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è¦æ ¡éªŒå®¢æˆ·ç«¯çš„è¯ä¹¦

ç›¸å¯¹å¤æ‚

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F26%2Fc877b90370c978ce90e18d403f7c8f2f_20231026201330.png)

# 5. keytool

- æ˜¯JDKè‡ªå¸¦çš„ä¸€ä¸ªå¯†é’¥åº“ç®¡ç†å·¥å…·ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒç”Ÿäº§å¯†é’¥åº“ã€ç®¡ç†è¯ä¹¦

# 6. ä»é…ç½®å±æ€§è·å–å€¼/è‡ªå®šä¹‰å±æ€§

`@ConfigurationProperties(prefix=<>)`ä»`yaml`ä¸­åŠ è½½å±æ€§å€¼

é€šè¿‡application.ymlæ–‡ä»¶æä¾›å€¼  
ç¯å¢ƒå˜é‡ï¼štaco_orders_pageSize=12  
ç¨‹åºå‚æ•°ï¼š--taco.orders.pageSize=13  
è®¿é—®ï¼šhttp://localhost:8080/orders

# 7. å¤šä¸ªProfileæ–‡ä»¶

## 7.1. å‘½åè§„åˆ™

Profileæ–‡ä»¶å‘½åæœ‰å›ºå®šè§„åˆ™

- å®šä¹‰ç‰¹å®šprofileçš„å±æ€§ï¼Œé€šè¿‡ä½¿ç”¨ä¸åŒçš„YAMLæˆ–å±æ€§æ–‡ä»¶  
	- âœ“ application-{profileå}.properties  
	- âœ“ application-{profileå}.yml  
- ä¹Ÿå¯ä»¥å°†ä¸åŒprofileå±æ€§æ”¾åˆ°åŒä¸€ä¸ªYAMLæ–‡ä»¶ä¸­ï¼Œä½¿ç”¨3ä¸ªçŸ­çº¿è¿›è¡Œåˆ†éš”ï¼Œå¹¶ä¸”ä½¿ç”¨spring.profileså±æ€§æ¥å‘½åprofile

## 7.2. æ¿€æ´»Profile

- ç¯å¢ƒå˜é‡ï¼šspring_profiles_active=prod
- å‘½ä»¤è¡Œå‚æ•°ï¼šjava -jar <>.jar --spring.profiles.active=prod
- JVMç³»ç»Ÿå±æ€§ï¼šjava -Dspring.profiles.active=prod -jar <>.jar
- ä½¿ç”¨æ³¨è§£`@Profile`æ¡**ä»¶åŒ–åœ°åˆ›å»ºBean**ï¼Œå¯ä»¥åŠ åˆ°`@Configuration`æˆ–`@Bean`ä¸Š
	- åœºæ™¯ï¼šæµ‹è¯•ç¯å¢ƒä¸‹åˆå§‹åŒ–æ•°æ®åº“å¡«å……æµ‹è¯•æ•°æ®ï¼Œä½†æ˜¯åœ¨ç”Ÿäº§ç¯å¢ƒä¸‹ä¸èƒ½ä¹±åˆå§‹åŒ–

# 8. é…ç½®æ—¥å¿—

- é»˜è®¤Logback,é…ç½®æ–‡ä»¶logback.xml
- é»˜è®¤æ—¥å¿—çº§åˆ«: INFO
- æ—¥å¿—é…ç½®(application.yml)
	- å¯ä»¥æ ¹æ®ä¸åŒåŒ…è·¯å¾„è®¾ç½®ä¸åŒæ—¥å¿—çº§åˆ«

```yaml
logging:
  level:
    root: WARN
    org:
      Springframework:
	    security: DEBUG
```

# 9. ActuatorğŸ‘

- æä¾›è®¸å¤š**ç«¯ç‚¹(endpoints)**, ç›‘æµ‹ç¨‹åºè¿è¡Œæƒ…å†µ
	- /actuatorï¼ŒæŸ¥è¯¢æ‰€æœ‰æš´éœ²ç«¯ç‚¹
	- /actuator/configpropsï¼ŒæŸ¥è¯¢é…ç½®å±æ€§
	- /actuator/healthï¼Œå¥åº·æ£€æŸ¥
	- /actuator/beansï¼ŒåŒ…å«beanä¾èµ–å…³ç³»

```yaml
management:
  endpoints:
    web:
      exposure:
        include: "*"
```

`include: "*"`æš´éœ²æ‰€æœ‰ç«¯å£, å¦åˆ™åªæš´éœ²`/actuator/health`
