---
aliases: 
tags: 
categories:
sticky:
thumbnail:
cover: 
excerpt: false
mathjax: true
comment: true
title: 16-k8s使用
date:  Thursday,December 28th 2023
modified:  Thursday,December 28th 2023
---

# k8s环境

## 安装

[GitHub - AliyunContainerService/k8s-for-docker-desktop: 为Docker Desktop for Mac/Windows开启Kubernetes和Istio。](https://github.com/AliyunContainerService/k8s-for-docker-desktop)

根据说明安装

## 部署dashboard

`kubectl apply -f kubernetes-dashboard.yaml`

kubectl： 客户端程序与远程k8s server交互  
kubectl proxy： 把远程k8s server端口代理到本地端口

## 部署ingress controller

`kubectl apply -f ingress-nginx-controller.yaml`

## 验证 Kubernetes 集群状态

 - kubectl cluster-info
 - kubectl get nodes
 - kubectl get nodes --show-labels
 - 给节点打标签：kubectl label node docker-desktop disktype=ssd
	 - 查询满足标签的节点：kubectl get nodes   -l disktype=ssd
	 - 删除标签：kubectl label node docker-desktop disktype


# k8s基本架构

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F12%2F28%2F18-55-11-2838e48395432e6ee0c51d6f1cbf08d5-20231228185510-36573e.png)


Node: 安装docker的宿主机，提供容器。
Master：管理集群的机器，安装k8s的核心模块。也可以与Node部署在同一台宿主机上。

kubelet：替Master与docker交互。
flannel：容器网络的第三方实现，给容器提供虚拟网络。
etcd：类似reddis的缓存系统。

k8s目的：通过多个Node节点，获得更多容器。


# k8s资源👍

- namespaces
	- 类似java中的package
	- 可以把不同资源放在不同namespace里，不同namespace里面可以有同名资源
- Pods
	- 以包含一个或多个容器，内部容器的逻辑宿主机
- Deployment
	- 负责Pod的自动创建
- Service
	- 类似微服务的“服务”概念，为外界提供一定的业务能力
	- 部署在Pod中，一个服务可以有多个Pod
- Ingress
	- 网关，把不同域名/url路由到对应的服务
	- k8s对外统一提供Ingress的入口
- configmap
	- 集群中提供配置信息的地方
	- key-value结构
- secrets
	- 涉及安全的隐私数据，有不同类别
- service