# 嵌入式软件软件架构

1. 业务逻辑
2. 实时依赖硬件的逻辑

移植很重要，因为嵌入式平台很多。

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F23%2Fc20c1ac5f4bc3df54353a1b6adfe3999_20231023102928.png)
抽象层将所需操作的高级请求转换为操作所需的低级命令

# 嵌入式软件架构模式

## 非结构化单体架构

1. 很容易构建，但很难维持规模和移植
2. 和应用层的应用程序紧密耦合

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F23%2Ff428f40da33f3eb734968e0818e925b1_20231023102633.png)

## 分层架构

1. 如今嵌入式应用程序最常用的架构
2. 将应用程序的逻辑划分为若干独立层，仅通过定义良好的抽象层进行交互
3. 试图通过将应用程序分解为独立的层来改善非结构化单体架构的高耦合性

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F23%2F52234cc5d6dfafe6a83cc418b26533ab_20231023102955.png)

## 事件驱动架构

- 对于实时嵌入式应用程序和能耗相关的应用程序非常有意义
- 常用**中断来响应事件**
- 事件驱动的体系结构通常使用消息队列、信号量和事件标志来表示系统 中发生了事件

- 优点
	- 具有相对的可扩展性
	- 软件模块通常具有高内聚性
	- 具有低耦合
- 缺点
	- 无论要做任何事情，都需要额外开销和复杂性

 ![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F23%2Fb421fdab5c5b283656a20d00f56656ef_20231023103638.png)

## 微服务架构

- 微服务架构将应用程序构建为业务领域开发的小型自治服务的集合
- 本质：低耦合，使得微服务易于维护和可测试，开发人员可以快速扩展和一直微服务
- 围绕系统业务逻辑组织的。业务逻辑是视图行为的业务规则和用例

![image.png](https://chillcharlie-img.oss-cn-hangzhou.aliyuncs.com/image%2F2023%2F10%2F23%2F06bad78c3130dc45e0498e72861162e3_20231023103943.png)

- 不足
	1. 在架构上，增加设计的复杂性
	2. 其次，由于具有其他体系结构中可能不需要的通信特性，它们可能会增加额外的开销和内存需求
	3. 架构的分散性也意味着实时的、确定性的行为可能更具挑战性。实时和响应可能有额外的抖动
	4. 可能会增加开发时间和预算


## 微内核架构


- 微内核架构（Microkernel Architecture），也称插件化架构（Plugin Architecture），是一种面向功能拆分的可扩展性架构
- 包含两类组件
	1. 核心系统（core system）
	2. 插件系统（plug-in modules）
- 优点
	- 微内核天生具备的模块化解耦、弹性部署的能力以及安全稳定的特 性，非常符合物联网的发展
- 缺点
	- 进程间通信（IPC Inter Process Communication）的性能无疑成为 微内核的软肋

# 常用设计模式

1. 单核
2. 多核
3. 发布和订阅模型
4. RTOS模式
5. 处理中断和低功耗设计

# 管理外设数据

- 主要的设计理念之一是**数据决定设计**。在设计嵌入式软件时，必须遵循数据。

- 设计机制
	1. 轮询
	2. 中断
	3. 直接存储访问DMA

## 轮询


